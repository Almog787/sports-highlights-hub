<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8NEMWLX7BF"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-8NEMWLX7BF');
    </script>

    <meta name="google-adsense-account" content="ca-pub-3359114283161345">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>דשבורד גננות | המרכז המוזיקלי המשולב</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;500;800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    
    <style>
        :root {
            --purim-color: #9c27b0;
            --morning-color: #ff9800;
            --movement-color: #4caf50;
            --classics-color: #2196f3;
            --relax-color: #607d8b;
            --manual-color: #e67e22;
        }
        
        body { background-color: #f0f2f5; font-family: 'Assistant', sans-serif; min-height: 100vh; display: flex; flex-direction: column; }
        
        .category-bar {
            background: white;
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow-x: auto;
            white-space: nowrap;
        }

        .nav-btn {
            border: none;
            background: none;
            padding: 10px 20px;
            margin: 0 5px;
            border-radius: 12px;
            font-weight: 800;
            transition: 0.3s;
            display: inline-flex;
            align-items: center; gap: 8px;
        }

        .btn-purim { color: var(--purim-color); border: 1px solid var(--purim-color); }
        .btn-purim.active { background: var(--purim-color); color: white; }
        .btn-morning { color: var(--morning-color); border: 1px solid var(--morning-color); }
        .btn-morning.active { background: var(--morning-color); color: white; }
        .btn-movement { color: var(--movement-color); border: 1px solid var(--movement-color); }
        .btn-movement.active { background: var(--movement-color); color: white; }
        .btn-classics { color: var(--classics-color); border: 1px solid var(--classics-color); }
        .btn-classics.active { background: var(--classics-color); color: white; }
        .btn-manual { color: var(--manual-color); border: 1px solid var(--manual-color); }
        .btn-manual.active { background: var(--manual-color); color: white; }

        .stream-grid { display: none; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; padding: 20px 0; }
        .stream-grid.active { display: grid; }

        .video-card {
            background: white;
            border-radius: 18px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            border-bottom: 4px solid #ccc;
        }

        .video-container { position: relative; padding-bottom: 56.25%; height: 0; background-color: #000; cursor: pointer; }
        .video-container img { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0.8; transition: opacity 0.3s; }
        .video-container:hover img { opacity: 1; }
        
        .play-button {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 60px; height: 60px; background-color: rgba(255, 0, 0, 0.9);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            color: white; font-size: 30px; z-index: 2; transition: 0.3s;
        }
        .video-container:hover .play-button { transform: translate(-50%, -50%) scale(1.1); background-color: #f00; }
        
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .video-title { padding: 12px; font-weight: 600; font-size: 0.9rem; height: 60px; overflow: hidden; }

        footer { background: white; padding: 20px 0; margin-top: auto; border-top: 1px solid #eee; }
        .credit-text { color: #555; font-weight: 600; margin: 0; }
        
        /* עיצוב משופר לשעון ולתאריך */
        #current-time-container { font-size: 0.9rem; line-height: 1.2; text-align: left; }
    </style>
</head>
<body>

<header class="bg-white py-3 border-bottom">
    <div class="container d-flex justify-content-between align-items-center">
        <h2 class="m-0 fw-800 text-primary"><i class="bi bi-music-note-beamed"></i> דשבורד גננות</h2>
        <div id="current-time-container" class="badge bg-light text-dark p-2 border">
            <div id="clock-time" class="fw-bold fs-6"></div>
            <div id="date-hebrew" style="font-size: 0.75rem; color: #666;"></div>
            <div id="date-gregorian" style="font-size: 0.75rem; color: #666;"></div>
        </div>
    </div>
</header>

<div class="category-bar">
    <div class="container d-flex">
        <button class="nav-btn btn-manual active" onclick="switchCat('manual_section', this)">
            <i class="bi bi-star-fill"></i> המבחר שלי
        </button>
        <button class="nav-btn btn-purim" onclick="switchCat('purim', this)"><i class="bi bi-mask"></i> פורים</button>
        <button class="nav-btn btn-morning" onclick="switchCat('morning_circle', this)"><i class="bi bi-sun"></i> מפגש בוקר</button>
        <button class="nav-btn btn-movement" onclick="switchCat('movement_play', this)"><i class="bi bi-person-walking"></i> תנועה והפעלה</button>
        <button class="nav-btn btn-classics" onclick="switchCat('israeli_classics', this)"><i class="bi bi-flag"></i> שירי ילדות</button>
        <button class="nav-btn btn-relax" style="color:var(--relax-color); border:1px solid var(--relax-color);" onclick="switchCat('relaxation_sleep', this)"><i class="bi bi-moon-stars"></i> מנוחה</button>
    </div>
</div>

<main class="container py-4">
    <div id="manual_section" class="stream-grid active"></div>
    <div id="purim" class="stream-grid"></div>
    <div id="morning_circle" class="stream-grid"></div>
    <div id="movement_play" class="stream-grid"></div>
    <div id="israeli_classics" class="stream-grid"></div>
    <div id="relaxation_sleep" class="stream-grid"></div>
</main>

<footer>
    <div class="container text-center">
        <p class="m-0 text-muted">נבנה באהבה לגננות ישראל &copy; 2026</p>
        <p class="credit-text">Developed by Almog787</p>
    </div>
</footer>

<script>
    function switchCat(id, btn) {
        document.querySelectorAll('.stream-grid').forEach(g => g.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
    }

    function loadVideo(container, videoUrl) {
        container.innerHTML = `<iframe src="${videoUrl}&autoplay=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
    }

    function getThumb(url) {
        const id = url.split('/embed/')[1]?.split('?')[0];
        return `https://img.youtube.com/vi/${id}/mqdefault.jpg`;
    }

    async function initDashboard() {
        try {
            const resAuto = await fetch('streams.json?v=' + Date.now());
            const dataAuto = await resAuto.json();

            let dataManual = { my_links: [] };
            try {
                const resManual = await fetch('manual_links.json?v=' + Date.now());
                if (resManual.ok) dataManual = await resManual.json();
            } catch (e) { console.warn("Manual links file not found."); }

            const allData = { 
                ...dataAuto, 
                "manual_section": dataManual.my_links || [] 
            };
            
            for (const [key, items] of Object.entries(allData)) {
                const grid = document.getElementById(key);
                if (!grid) continue;
                
                grid.innerHTML = items.map(item => `
                    <div class="video-card">
                        <div class="video-container" onclick="loadVideo(this, '${item.url}')">
                            <img src="${getThumb(item.url)}" alt="${item.title}" loading="lazy">
                            <div class="play-button"><i class="bi bi-play-fill"></i></div>
                        </div>
                        <div class="video-title">${item.title}</div>
                    </div>
                `).join('');
            }
        } catch (e) { console.error("שגיאה בטעינת הקבצים:", e); }
    }

    // עדכון שעון ותאריך
    function updateDateTime() {
        const now = new Date();
        
        // שעון
        document.getElementById('clock-time').innerText = now.toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
        
        // תאריך לועזי
        document.getElementById('date-gregorian').innerText = now.toLocaleDateString('he-IL', { day: 'numeric', month: 'long', year: 'numeric' });
        
        // תאריך עברי
        const hebrewDate = new Intl.DateTimeFormat('he-IL-u-ca-hebrew', { day: 'numeric', month: 'long', year: 'numeric' }).format(now);
        document.getElementById('date-hebrew').innerText = hebrewDate;
    }

    setInterval(updateDateTime, 1000);
    updateDateTime(); // הרצה ראשונית

    initDashboard();
</script>

</body>
</html>
