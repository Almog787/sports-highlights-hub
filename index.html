<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8NEMWLX7BF"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-8NEMWLX7BF');
    </script>

    <meta name="google-adsense-account" content="ca-pub-3359114283161345">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>דשבורד גננות | המרכז המוזיקלי המשולב</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;500;800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    
    <style>
        :root {
            --purim-color: #9c27b0;
            --morning-color: #ff9800;
            --movement-color: #4caf50;
            --classics-color: #2196f3;
            --relax-color: #607d8b;
            --manual-color: #e67e22; /* צבע לקטגוריה הידנית */
        }
        
        body { background-color: #f0f2f5; font-family: 'Assistant', sans-serif; }
        
        .category-bar {
            background: white;
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow-x: auto;
            white-space: nowrap;
        }

        .nav-btn {
            border: none;
            background: none;
            padding: 10px 20px;
            margin: 0 5px;
            border-radius: 12px;
            font-weight: 800;
            transition: 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-purim { color: var(--purim-color); border: 1px solid var(--purim-color); }
        .btn-purim.active { background: var(--purim-color); color: white; }
        
        .btn-morning { color: var(--morning-color); border: 1px solid var(--morning-color); }
        .btn-morning.active { background: var(--morning-color); color: white; }

        .btn-movement { color: var(--movement-color); border: 1px solid var(--movement-color); }
        .btn-movement.active { background: var(--movement-color); color: white; }

        .btn-classics { color: var(--classics-color); border: 1px solid var(--classics-color); }
        .btn-classics.active { background: var(--classics-color); color: white; }

        .btn-manual { color: var(--manual-color); border: 1px solid var(--manual-color); }
        .btn-manual.active { background: var(--manual-color); color: white; }

        .stream-grid { display: none; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; padding: 20px 0; }
        .stream-grid.active { display: grid; }

        .video-card {
            background: white;
            border-radius: 18px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            border-bottom: 4px solid #ccc;
        }

        .video-container { position: relative; padding-bottom: 56.25%; height: 0; }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

        .video-title { padding: 12px; font-weight: 600; font-size: 0.9rem; height: 60px; overflow: hidden; }
    </style>
</head>
<body>

<header class="bg-white py-3 border-bottom">
    <div class="container d-flex justify-content-between align-items-center">
        <h2 class="m-0 fw-800 text-primary"><i class="bi bi-music-note-beamed"></i> דשבורד גננות</h2>
        <span id="current-time" class="badge bg-light text-dark p-2"></span>
    </div>
</header>

<div class="category-bar">
    <div class="container d-flex">
        <button class="nav-btn btn-manual active" onclick="switchCat('manual_section', this)">
            <i class="bi bi-star-fill"></i> המבחר שלי
        </button>
        <button class="nav-btn btn-purim" onclick="switchCat('purim', this)"><i class="bi bi-mask"></i> פורים</button>
        <button class="nav-btn btn-morning" onclick="switchCat('morning_circle', this)"><i class="bi bi-sun"></i> מפגש בוקר</button>
        <button class="nav-btn btn-movement" onclick="switchCat('movement_play', this)"><i class="bi bi-person-walking"></i> תנועה והפעלה</button>
        <button class="nav-btn btn-classics" onclick="switchCat('israeli_classics', this)"><i class="bi bi-flag"></i> שירי ילדות</button>
        <button class="nav-btn btn-relax" style="color:var(--relax-color); border:1px solid var(--relax-color);" onclick="switchCat('relaxation_sleep', this)"><i class="bi bi-moon-stars"></i> מנוחה</button>
    </div>
</div>

<main class="container py-4">
    <div id="manual_section" class="stream-grid active"></div>
    
    <div id="purim" class="stream-grid"></div>
    <div id="morning_circle" class="stream-grid"></div>
    <div id="movement_play" class="stream-grid"></div>
    <div id="israeli_classics" class="stream-grid"></div>
    <div id="relaxation_sleep" class="stream-grid"></div>
</main>

<script>
    function switchCat(id, btn) {
        document.querySelectorAll('.stream-grid').forEach(g => g.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
    }

    async function initDashboard() {
        try {
            // 1. טעינת נתונים אוטומטיים
            const resAuto = await fetch('streams.json?v=' + Date.now());
            const dataAuto = await resAuto.json();

            // 2. טעינת נתונים ידניים
            let dataManual = { my_links: [] };
            try {
                const resManual = await fetch('manual_links.json?v=' + Date.now());
                if (resManual.ok) dataManual = await resManual.json();
            } catch (e) { console.warn("Manual links file not found."); }

            // איחוד ומיפוי נתונים
            const allData = { 
                ...dataAuto, 
                "manual_section": dataManual.my_links || [] 
            };
            
            for (const [key, items] of Object.entries(allData)) {
                const grid = document.getElementById(key);
                if (!grid) continue;
                
                grid.innerHTML = items.map(item => `
                    <div class="video-card">
                        <div class="video-container">
                            <iframe src="${item.url}" allowfullscreen loading="lazy"></iframe>
                        </div>
                        <div class="video-title">${item.title}</div>
                    </div>
                `).join('');
            }
        } catch (e) { console.error("שגיאה בטעינת הקבצים:", e); }
    }

    setInterval(() => {
        const now = new Date();
        document.getElementById('current-time').innerText = now.toLocaleTimeString('he-IL');
    }, 1000);

    initDashboard();
</script>

</body>
</html>
