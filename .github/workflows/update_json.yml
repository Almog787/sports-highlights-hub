name: Pending Content Update
on:
  repository_dispatch:
    types: [update_data]

jobs:
  create-pr:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Create New Branch and Update JSON
        env:
          DATA: ${{ github.event.client_payload.data }}
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}
        run: |
          # 爪专转 砖 注祝 
          BRANCH_NAME="update-$(date +%s)"
          git checkout -b $BRANCH_NAME
          
          # 转转 转 拽抓
          echo "$DATA" > manual_links.json
          
          # 专转 
          git config --global user.name "Admin Dashboard"
          git config --global user.email "admin@dashboard.com"
          
          git add manual_links.json
          git commit -m "注 转  - 转 砖专"
          git push origin $BRANCH_NAME

          # 爪专转 -Pull Request 注专转 -CLI  砖 GitHub
          gh pr create \
            --title " 注 转 砖 " \
            --body "转拽 注 转 砖. 抓 注 Merge  注 转 转专 驻注." \
            --base main \
            --head $BRANCH_NAME
